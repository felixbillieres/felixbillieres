# ðŸ«¨ Windows Privilege Escalation

The general goal of Windows privilege escalation is to further our access to a given system to a member of the `Local Administrators` group or the `NT AUTHORITY\SYSTEM` [LocalSystem](https://docs.microsoft.com/en-us/windows/win32/services/localsystem-account) account

&#x20;we may need to escalate privileges for one of the following reasons:

<table><thead><tr><th width="72"></th><th></th></tr></thead><tbody><tr><td>1.</td><td>When testing a client's <a href="https://www.techopedia.com/definition/29456/golden-image">gold image</a> Windows workstation and server build for flaws</td></tr><tr><td>2.</td><td>To escalate privileges locally to gain access to some local resource such as a database</td></tr><tr><td>3.</td><td>To gain <a href="https://docs.microsoft.com/en-us/windows/win32/services/localsystem-account">NT AUTHORITY\System</a> level access on a domain-joined machine to gain a foothold into the client's Active Directory environment</td></tr><tr><td>4.</td><td>To obtain credentials to move laterally or escalate privileges within the client's network</td></tr></tbody></table>

some of the ways that we can escalate privileges are:

|                                      |                                       |
| ------------------------------------ | ------------------------------------- |
| Abusing Windows group privileges     | Abusing Windows user privileges       |
| Bypassing User Account Control       | Abusing weak service/file permissions |
| Leveraging unpatched kernel exploits | Credential theft                      |
| Traffic Capture                      | and more.                             |

is a list of useful binaries and scripts ->

<table><thead><tr><th width="182">Tool</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/GhostPack/Seatbelt">Seatbelt</a></td><td>C# project for performing a wide variety of local privilege escalation checks</td></tr><tr><td><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS">winPEAS</a></td><td>WinPEAS is a script that searches for possible paths to escalate privileges on Windows hosts. All of the checks are explained <a href="https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation">here</a></td></tr><tr><td><a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1">PowerUp</a></td><td>PowerShell script for finding common Windows privilege escalation vectors that rely on misconfigurations. It can also be used to exploit some of the issues found</td></tr><tr><td><a href="https://github.com/GhostPack/SharpUp">SharpUp</a></td><td>C# version of PowerUp</td></tr><tr><td><a href="https://github.com/411Hall/JAWS">JAWS</a></td><td>PowerShell script for enumerating privilege escalation vectors written in PowerShell 2.0</td></tr><tr><td><a href="https://github.com/Arvanaghi/SessionGopher">SessionGopher</a></td><td>SessionGopher is a PowerShell tool that finds and decrypts saved session information for remote access tools. It extracts PuTTY, WinSCP, SuperPuTTY, FileZilla, and RDP saved session information</td></tr><tr><td><a href="https://github.com/rasta-mouse/Watson">Watson</a></td><td>Watson is a .NET tool designed to enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities.</td></tr><tr><td><a href="https://github.com/AlessandroZ/LaZagne">LaZagne</a></td><td>Tool used for retrieving passwords stored on a local machine from web browsers, chat tools, databases, Git, email, memory dumps, PHP, sysadmin tools, wireless network configurations, internal Windows password storage mechanisms, and more</td></tr><tr><td><a href="https://github.com/bitsadmin/wesng">Windows Exploit Suggester - Next Generation</a></td><td>WES-NG is a tool based on the output of Windows' <code>systeminfo</code> utility which provides the list of vulnerabilities the OS is vulnerable to, including any exploits for these vulnerabilities. Every Windows OS between Windows XP and Windows 10, including their Windows Server counterparts, is supported</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite">Sysinternals Suite</a></td><td>We will use several tools from Sysinternals in our enumeration including <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk">AccessChk</a>, <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pipelist">PipeList</a>, and <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psservice">PsService</a></td></tr></tbody></table>

We can also find pre-compiled binaries of `Seatbelt` and `SharpUp` [here](https://github.com/r3motecontrol/Ghostpack-CompiledBinaries), and standalone binaries of `LaZagne` [here](https://github.com/AlessandroZ/LaZagne/releases/).

When we don't find writeable directories,  It is always a safe bet to upload tools to `C:\Windows\Temp` because the `BUILTIN\Users` group has write access.
